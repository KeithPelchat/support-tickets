generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model SupportRequest {
  id            String                 @id @default(cuid())
  clientId      String                 @map("client_id")
  requestType   String                 @map("request_type")
  description   String
  status        String                 @default("new")
  internalNotes String?                @map("internal_notes")
  createdAt     DateTime               @default(now()) @map("created_at")
  updatedAt     DateTime               @updatedAt @map("updated_at")
  images        SupportRequestImage[]
  messages      Message[]

  @@map("support_requests")
}

model Message {
  id         String         @id @default(cuid())
  requestId  String         @map("request_id")
  content    String
  senderType String         @map("sender_type") // "admin" or "client"
  createdAt  DateTime       @default(now()) @map("created_at")
  request    SupportRequest @relation(fields: [requestId], references: [id], onDelete: Cascade)

  @@map("messages")
}

model SupportRequestImage {
  id         String         @id @default(cuid())
  requestId  String         @map("request_id")
  imageUrl   String         @map("image_url")
  filename   String
  size       Int
  uploadedAt DateTime       @default(now()) @map("uploaded_at")
  request    SupportRequest @relation(fields: [requestId], references: [id], onDelete: Cascade)

  @@map("support_request_images")
}

model ClientToken {
  token       String   @id
  clientId    String   @map("client_id")
  clientName  String   @map("client_name")
  clientEmail String?  @map("client_email")
  createdAt   DateTime @default(now()) @map("created_at")

  @@map("client_tokens")
}
